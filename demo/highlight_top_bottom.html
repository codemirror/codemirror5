<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Demo: Highlight Top and Bottom Lines</title>
    <link rel="stylesheet" href="../lib/codemirror.css">
    <script src="../lib/codemirror.js"></script>
    <script src="../keymap/vim.js"></script>
    <script src="../mode/xml/xml.js"></script>
    <link rel="stylesheet" href="../doc/docs.css">

    <style type="text/css">
      .CodeMirror {border-top: 1px solid black; border-bottom: 1px solid black;}
      .CodeMirror-activeline-background {background: #e8f2ff !important;}
    </style>
  </head>
  <body>
    <h1>Demo: Top Line and Bottom Line</h1>

    <span>
    <span id='label'></span>
    <input id='slider' type='range' max='800' min='100' style='width:100%'></input>
    </span>
    <form>
      <br>
      <br>
      <textarea id="code" name="code">
<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"
  xmlns:georss="http://www.georss.org/georss"
  xmlns:twitter="http://api.twitter.com">
    <channel>
        <title>Twitter / codemirror</title>
        <link>http://twitter.com/codemirror</link>
        <atom:link type="application/rss+xml"
        href="http://twitter.com/statuses/user_timeline/242283288.rss" rel="self"/>
        <description>Twitter updates from CodeMirror / codemirror.</description>
        <language>en-us</language>
        <ttl>40</ttl>
        <item>
            <title>codemirror: http://cloud-ide.com &#8212; they're springing up like mushrooms. This one
              uses CodeMirror as its editor.</title>
            <description>codemirror: http://cloud-ide.com &#8212; they're springing up like mushrooms. This
              one uses CodeMirror as its editor.</description>
            <pubDate>Thu, 17 Mar 2011 23:34:47 +0000</pubDate>
            <guid>http://twitter.com/codemirror/statuses/48527733722058752</guid>
            <link>http://twitter.com/codemirror/statuses/48527733722058752</link>
            <twitter:source>web</twitter:source>
            <twitter:place/>
        </item>
    </channel>
</rss>
      </textarea>
    </form>

    <p>
    Press key H, M, L to jump between top, bottom and middle lines.
    Use the scroll bar to resize to height of editor.
    </p>

    <script>
      var textarea = document.getElementById("code");
      var slider = document.getElementById("slider");
      var label = document.getElementById("label");
      textarea.value += textarea.value;
      textarea.value += textarea.value;
      textarea.value += textarea.value;
      var editor = CodeMirror.fromTextArea(textarea, {
        mode: 'application/xml',
        keyMap: 'vim',
        lineNumbers: true,
        lineWrapping: true
      });

      var oldTopLine=0, oldBottomLine=0;
      editor.on('scroll', function(cm){
        updateHighlight();
      })

      function updateHighlight() {
        var range = CodeMirror.Vim.getUserVisibleLines(editor);
        editor.removeLineClass(oldTopLine, 'background','CodeMirror-activeline-background');
        editor.removeLineClass(oldBottomLine, 'background','CodeMirror-activeline-background');
        editor.addLineClass(range.from, 'background','CodeMirror-activeline-background');
        editor.addLineClass(range.to, 'background','CodeMirror-activeline-background');
        oldTopLine = range.from;
        oldBottomLine = range.to;
      }

      slider.onchange = function(e) {
        var target = e.target;
        console.log(e);
        editor.display.wrapper.style.height = target.value + 'px';
        label.innerText = target.value + ' pixels';
        updateHighlight();
      }
      window.addEventListener('keydown', updateHighlight, true);
      updateHighlight();
    </script>

  </body>
</html>
